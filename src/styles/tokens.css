:root {
  --font-family-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-mono: "JetBrains Mono", "SF Mono", "Fira Code", "Consolas", monospace;

  /*
   * Typography system (3 tiers):
   * - body: default copy and control text
   * - heading: section and panel titles
   * - display: glance-priority numeric emphasis (e.g., timer)
   * Default to body unless content needs stronger hierarchy.
   */
  --type-scale-1: 0.95rem;
  --type-scale-2: 1.15rem;
  --type-scale-3: 1.55rem;
  --type-scale-4: var(--type-scale-3);
  --type-scale-5: var(--type-scale-3);
  --type-scale-6: var(--type-scale-3);

  /* Consolidated semantic size tiers */
  --type-size-body: var(--type-scale-1);
  --type-size-heading: var(--type-scale-2);
  --type-size-display: var(--type-scale-3);

  /* Primitive type rhythm */
  --type-weight-regular: 400;
  --type-weight-medium: 500;
  --type-weight-semibold: 600;
  --type-weight-bold: 700;
  --type-family-ui: var(--font-family-sans);
  --type-family-data: var(--type-family-ui);
  --type-leading-tight: 1;
  --type-leading-snug: 1.2;
  --type-leading-normal: 1.3;
  --type-leading-comfy: 1.35;
  --type-leading-relaxed: 1.4;
  --type-leading-loose: 1.45;
  --type-tracking-none: 0;
  --type-tracking-tight: 0.01em;
  --type-tracking-brand: 0.02em;
  --type-tracking-label: 0.04em;
  --type-tracking-table: 0.02em;
  --type-tracking-timer: 0.05em;

  --leading-tight: 1.2;
  --tracking-label: 0.1em;
  --tracking-section: 0.08em;
  --tracking-table: 0.05em;
  --tracking-timer: 0.05em;

  /* Semantic typography roles */
  --type-role-app-status-size: var(--type-size-body);
  --type-role-brand-size: var(--type-size-body);
  --type-role-brand-weight: var(--type-weight-semibold);
  --type-role-brand-tracking: var(--type-tracking-none);
  --type-role-streak-size: var(--type-size-body);
  --type-role-streak-weight: var(--type-weight-semibold);
  --type-role-source-size: var(--type-size-body);
  --type-role-source-weight: var(--type-weight-medium);
  --type-role-source-leading: var(--type-leading-tight);
  --type-role-label-size: var(--type-size-body);
  --type-role-label-weight: var(--type-weight-medium);
  --type-role-label-tracking: var(--type-tracking-label);
  --type-role-label-compact-tracking: var(--type-tracking-table);
  --type-role-button-size: var(--type-size-body);
  --type-role-button-weight: var(--type-weight-medium);
  --type-role-button-strong-weight: var(--type-weight-semibold);
  --type-role-action-nav-size: var(--type-size-body);
  --type-role-keycap-size: var(--type-size-body);
  --type-role-keycap-weight: var(--type-weight-semibold);
  --type-role-keycap-leading: var(--type-leading-snug);
  --type-role-metric-size: var(--type-size-body);
  --type-role-timer-size: var(--type-size-display);
  --type-role-timer-weight: var(--type-weight-semibold);
  --type-role-timer-tracking: var(--type-tracking-none);
  --type-role-timer-leading: var(--type-leading-snug);
  --type-role-timer-label-size: var(--type-size-body);
  --type-role-timer-label-weight: var(--type-weight-medium);
  --type-role-timer-label-tracking: var(--type-tracking-none);
  --type-role-timer-label-leading: var(--type-leading-tight);

  --type-role-panel-title-size: var(--type-size-heading);
  --type-role-panel-title-weight: var(--type-weight-semibold);
  --type-role-panel-title-tracking: var(--type-tracking-none);
  --type-role-panel-title-leading: var(--type-leading-tight);
  --type-role-panel-close-icon-size: var(--type-size-heading);
  --type-role-panel-close-icon-leading: var(--type-leading-tight);
  --type-role-panel-control-size: var(--type-size-body);
  --type-role-panel-tab-size: var(--type-size-body);
  --type-role-panel-badge-size: var(--type-size-body);
  --type-role-panel-badge-weight: var(--type-weight-semibold);
  --type-role-panel-support-size: var(--type-size-body);
  --type-role-panel-support-leading: var(--type-leading-relaxed);
  --type-role-panel-card-title-size: var(--type-size-body);
  --type-role-panel-card-title-weight: var(--type-weight-semibold);
  --type-role-panel-card-title-leading: var(--type-leading-snug);
  --type-role-panel-card-meta-size: var(--type-size-body);
  --type-role-panel-arrow-size: var(--type-size-heading);
  --type-role-panel-pill-size: var(--type-size-body);
  --type-role-panel-pill-weight: var(--type-weight-semibold);
  --type-role-panel-empty-icon-size: var(--type-size-heading);
  --type-role-panel-empty-icon-leading: var(--type-leading-tight);
  --type-role-panel-empty-title-size: var(--type-size-body);
  --type-role-panel-empty-title-weight: var(--type-weight-semibold);
  --type-role-panel-empty-subtitle-size: var(--type-size-body);
  --type-role-panel-section-title-size: var(--type-size-body);
  --type-role-panel-section-title-weight: var(--type-weight-semibold);
  --type-role-panel-section-title-leading: var(--type-leading-snug);
  --type-role-panel-section-subtitle-size: var(--type-size-body);
  --type-role-panel-section-subtitle-leading: var(--type-leading-normal);
  --type-role-panel-overall-size: var(--type-size-body);
  --type-role-panel-overall-weight: var(--type-weight-semibold);
  --type-role-panel-overall-meta-size: var(--type-size-body);
  --type-role-panel-overall-meta-leading: var(--type-leading-normal);
  --type-role-panel-speed-time-size: var(--type-size-display);
  --type-role-panel-speed-time-weight: var(--type-weight-semibold);
  --type-role-panel-speed-time-leading: var(--type-leading-tight);
  --type-role-panel-speed-trend-size: var(--type-size-body);
  --type-role-panel-speed-trend-weight: var(--type-weight-semibold);
  --type-role-panel-speed-trend-leading: var(--type-leading-snug);
  --type-role-panel-callout-title-size: var(--type-size-body);
  --type-role-panel-callout-title-leading: var(--type-leading-snug);
  --type-role-panel-callout-copy-size: var(--type-size-body);
  --type-role-panel-callout-copy-leading: var(--type-leading-loose);
  --type-role-panel-quick-value-size: var(--type-size-display);
  --type-role-panel-quick-value-weight: var(--type-weight-semibold);
  --type-role-panel-quick-value-leading: var(--type-leading-tight);
  --type-role-panel-quick-label-size: var(--type-size-body);
  --type-role-panel-quick-label-tracking: var(--type-tracking-label);

  --type-role-move-row-size: var(--type-size-body);
  --type-role-move-placeholder-size: var(--type-size-body);
  --type-role-puzzle-id-size: var(--type-size-heading);
  --type-role-puzzle-id-weight: var(--type-weight-semibold);
  --type-role-puzzle-id-leading: var(--type-leading-tight);
  --type-role-puzzle-total-size: var(--type-size-body);
  --type-role-puzzle-total-weight: var(--type-weight-regular);
  --type-role-puzzle-pill-size: var(--type-size-body);
  --type-role-puzzle-pill-weight: var(--type-weight-semibold);
  --type-role-puzzle-pill-tracking: var(--type-tracking-label);
  --type-role-puzzle-pill-leading: var(--type-leading-tight);
  --type-role-puzzle-meta-size: var(--type-size-body);
  --type-role-puzzle-meta-weight: var(--type-weight-semibold);
  --type-role-puzzle-status-size: var(--type-size-body);
  --type-role-puzzle-status-weight: var(--type-weight-semibold);
  --type-role-segment-size: var(--type-size-body);
  --type-role-segment-weight: var(--type-weight-medium);
  --type-role-segment-active-weight: var(--type-weight-semibold);

  --type-role-settings-control-title-size: var(--type-size-body);
  --type-role-settings-control-title-weight: var(--type-weight-semibold);
  --type-role-settings-control-title-tracking: var(--type-tracking-none);
  --type-role-settings-control-title-leading: var(--type-leading-snug);
  --type-role-settings-control-subtitle-size: var(--type-size-body);
  --type-role-settings-control-subtitle-leading: var(--type-leading-comfy);
  --type-role-settings-chip-size: var(--type-size-body);
  --type-role-settings-chip-leading: var(--type-leading-tight);
  --type-role-settings-chip-active-weight: var(--type-weight-semibold);
  --type-role-settings-chip-check-size: var(--type-size-body);
  --type-role-settings-chip-check-weight: var(--type-weight-bold);
  --type-role-settings-chip-check-leading: var(--type-leading-tight);
  --type-role-settings-slider-size: var(--type-size-body);
  --type-role-settings-slider-weight: var(--type-weight-semibold);
  --type-role-settings-slider-leading: var(--type-leading-tight);
  --type-role-settings-shell-title-size: var(--type-role-panel-section-title-size);
  --type-role-settings-shell-title-weight: var(--type-role-panel-section-title-weight);
  --type-role-settings-shell-title-leading: var(--type-role-panel-section-title-leading);
  --type-role-settings-shell-subtitle-size: var(--type-size-body);
  --type-role-settings-shell-subtitle-leading: var(--type-leading-loose);
  --type-role-toast-size: var(--type-size-body);

  --space-0: 0;
  --space-0_5: 0.125rem;
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-2_5: 0.625rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;

  --size-info-panel-min: 17.5rem;
  --size-info-panel-max: 22.5rem;
  --size-info-panel-offset: 21.25rem;
  --size-stats-modal-max-w: 67.5rem;
  --size-stats-modal-max-h: 48.75rem;
  --size-stats-close-min-w: 6.25rem;
  --size-stats-reset-min-w: 8.125rem;
  --size-mobile-breakpoint: 64rem;
  --size-app-padding-desktop: 1.5rem;
  --size-app-padding-mobile: 0.75rem;
  --size-safe-area-bottom: env(safe-area-inset-bottom, 0);
  --size-safe-area-left: env(safe-area-inset-left, 0);
  --size-safe-area-right: env(safe-area-inset-right, 0);
  --size-app-padding-mobile-safe-bottom: calc(var(--size-app-padding-mobile) + var(--size-safe-area-bottom));
  --size-app-padding-mobile-safe-inline-start: calc(var(--size-app-padding-mobile) + var(--size-safe-area-left));
  --size-app-padding-mobile-safe-inline-end: calc(var(--size-app-padding-mobile) + var(--size-safe-area-right));

  --radius-xs: 0.25rem;
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.625rem;
  --radius-xl: 0.75rem;
  --radius-full: 999px;

  --border-width-1: 1px;
  --border-width-strong: 3px;

  --duration-fast: 0.2s;
  --duration-moderate: 0.3s;
  --duration-pulse: 0.5s;
  --duration-toast: 2.5s;
  --ease-standard: ease;

  --opacity-disabled: 0.4;

  --z-overlay: 40;

  --color-bg-primary: #f7f8fc;
  --color-bg-panel: #ffffff;
  --color-bg-panel-section: #f0f2fa;
  --color-bg-overlay: rgb(16 20 31 / 82%);
  --color-bg-card-muted: rgb(224 228 242 / 70%);
  --color-bg-progress-track: rgb(10 12 20 / 16%);
  --color-bg-button: #dbe2f7;
  --color-bg-button-hover: #ced8f3;
  --color-bg-button-active: #2e8b57;
  --color-bg-button-active-hover: #297a4d;
  --color-bg-danger-soft: rgb(224 85 85 / 8%);

  --color-fg-primary: #1b2138;
  --color-fg-secondary: #4f5775;
  --color-fg-muted: #6f789b;
  --color-fg-inverse: #ffffff;

  --color-border-default: #c6cee8;
  --color-border-danger-soft: color-mix(in srgb, var(--color-accent-danger) 45%, var(--color-border-default));

  --color-accent-info: #a8780b;
  --color-accent-success: #2e8b57;
  --color-accent-danger: #d94a4a;
  --color-accent-danger-hover: #c13f3f;
  --color-accent-danger-soft: color-mix(in srgb, var(--color-accent-danger) 65%, transparent);
  --color-accent-danger-shadow: color-mix(in srgb, var(--color-accent-danger) 30%, transparent);
  --color-accent-success-border-soft: color-mix(
    in srgb,
    var(--color-accent-success) 60%,
    var(--color-border-default)
  );
  --color-accent-danger-border-soft: color-mix(
    in srgb,
    var(--color-accent-danger) 60%,
    var(--color-border-default)
  );

  --color-stats-overlay-bg: rgb(4 8 16 / 80%);
  --color-stats-modal-bg: linear-gradient(180deg, #050b17 0%, #07132b 100%);
  --color-stats-modal-border: rgb(255 255 255 / 9%);
  --color-stats-fg-primary: #e8ebf2;
  --color-stats-header-border: rgb(255 255 255 / 8%);
  --color-stats-title: #eef2f8;
  --color-stats-close-bg: rgb(27 36 57 / 78%);
  --color-stats-close-bg-hover: rgb(35 45 70 / 88%);
  --color-stats-close-border: rgb(255 255 255 / 7%);
  --color-stats-close-fg: #aeb8ca;
  --color-stats-close-fg-hover: #dee4ef;
  --color-stats-quick-bg: rgb(255 255 255 / 4%);
  --color-stats-quick-border: rgb(255 255 255 / 6%);
  --color-stats-quick-highlight-bg: rgb(251 191 36 / 12%);
  --color-stats-quick-highlight-border: rgb(251 191 36 / 40%);
  --color-stats-quick-value: #f7f9ff;
  --color-stats-quick-value-highlight: #f7c32f;
  --color-stats-quick-label: #74809a;
  --color-stats-tab-fg: #6d7790;
  --color-stats-tab-bg-active: linear-gradient(
    90deg,
    rgb(32 41 64 / 82%) 0%,
    rgb(40 46 61 / 70%) 100%
  );
  --color-stats-tab-fg-active: #f1f4f8;
  --color-stats-badge-bg: #f7c32f;
  --color-stats-badge-fg: #111827;
  --color-stats-retry-hint: #79839d;
  --color-stats-card-bg: linear-gradient(
    90deg,
    rgb(24 34 56 / 82%) 0%,
    rgb(30 43 70 / 65%) 100%
  );
  --color-stats-card-bg-retry: linear-gradient(
    90deg,
    rgb(24 34 56 / 82%) 0%,
    rgb(28 40 67 / 64%) 100%
  );
  --color-stats-card-bg-hover: linear-gradient(
    90deg,
    rgb(29 40 64 / 85%) 0%,
    rgb(34 47 76 / 68%) 100%
  );
  --color-stats-card-border: rgb(255 255 255 / 10%);
  --color-stats-card-border-hover: rgb(255 255 255 / 16%);
  --color-stats-card-fg: #e6ebf4;
  --color-stats-retry-meta: #808aa3;
  --color-stats-retry-arrow: #6e7890;
  --color-stats-mate-1-bg: rgb(34 197 94 / 30%);
  --color-stats-mate-2-bg: rgb(251 191 36 / 30%);
  --color-stats-mate-3-bg: rgb(249 115 22 / 30%);
  --color-stats-empty-title: #ecf1fb;
  --color-stats-empty-subtitle: #7f8aa3;
  --color-stats-section-title: #eef3fd;
  --color-stats-section-subtitle: #79849d;
  --color-stats-overall-position: #939eb3;
  --color-stats-overall-percent: #f2f6fd;
  --color-stats-progress-track-bg: rgb(255 255 255 / 12%);
  --color-stats-progress-fill-bg: linear-gradient(90deg, #2ddc71 0%, #4ade80 100%);
  --color-stats-overall-meta: #7f8aa3;
  --color-stats-speed-count: #9ca7bc;
  --color-stats-speed-time: #e9eef7;
  --color-stats-speed-up: #4ade80;
  --color-stats-speed-down: #f87171;
  --color-stats-speed-muted: #74809a;
  --color-stats-callout-bg: linear-gradient(
    90deg,
    rgb(34 197 94 / 18%) 0%,
    rgb(16 116 71 / 16%) 100%
  );
  --color-stats-callout-border: rgb(34 197 94 / 32%);
  --color-stats-callout-title: #4ade80;
  --color-stats-callout-copy: #9ca7bc;
  --color-stats-callout-strong: #f4f8ff;

  --color-board-theme-brown-light: #f0d9b5;
  --color-board-theme-brown-dark: #b58863;
  --color-board-theme-blue-light: #dee3e6;
  --color-board-theme-blue-dark: #8ca2ad;
  --color-board-theme-green-light: #ffffdd;
  --color-board-theme-green-dark: #86a666;
  --color-board-theme-gray-light: #dcdcdc;
  --color-board-theme-gray-dark: #8a8a8a;

  --color-settings-chip-bg: rgb(255 255 255 / 4%);
  --color-settings-chip-border: rgb(255 255 255 / 10%);
  --color-settings-chip-active-bg: color-mix(
    in srgb,
    var(--color-stats-tab-fg-active) 10%,
    var(--color-stats-tab-bg-active)
  );
  --color-settings-chip-active-border: color-mix(
    in srgb,
    var(--color-stats-badge-bg) 70%,
    var(--color-stats-card-border-hover)
  );
  --color-settings-chip-active-shadow: color-mix(in srgb, var(--color-stats-badge-bg) 35%, transparent);
  --color-settings-chip-check-bg: var(--color-stats-badge-bg);
  --color-settings-chip-check-fg: #111827;
  --color-settings-focus-ring: rgb(255 255 255 / 55%);
  --color-settings-divider-strong: rgb(255 255 255 / 9%);
  --color-settings-divider-soft: rgb(255 255 255 / 8%);
  --color-settings-swatch-border: rgb(255 255 255 / 24%);
  --color-settings-toggle-bg: rgb(255 255 255 / 12%);
  --color-settings-toggle-border: rgb(255 255 255 / 22%);
  --color-settings-toggle-on-bg: color-mix(in srgb, var(--color-accent-success) 42%, rgb(0 0 0 / 10%));
  --color-settings-toggle-on-border: color-mix(in srgb, var(--color-accent-success) 70%, rgb(255 255 255 / 15%));
  --color-settings-toggle-thumb-bg: #fff;
  --color-settings-slider-track-bg: rgb(255 255 255 / 16%);
  --color-settings-slider-thumb-ring: rgb(7 19 43 / 35%);

  --color-promotion-option-bg: color-mix(in srgb, var(--color-bg-panel) 88%, #bcc4d6);
  --color-promotion-option-border: color-mix(in srgb, var(--color-border-default) 72%, transparent);
  --color-promotion-primary-bg: color-mix(in srgb, #ef8f49 82%, #b75d2f);
  --color-promotion-primary-border: color-mix(in srgb, #ef8f49 74%, #a84f27);
  --color-promotion-focus-ring: rgb(255 255 255 / 55%);

  --shadow-danger-soft: 0 0 0.5rem var(--color-accent-danger-shadow);
  --shadow-success-clear: 0 0 0 transparent;
  --shadow-success-pulse: 0 0 1rem rgb(76 175 80 / 50%);
  --shadow-danger-clear: 0 0 0 transparent;
  --shadow-danger-pulse: 0 0 1rem rgb(224 85 85 / 60%);
}

@media (width <= 64rem) {
  :root {
    --type-role-brand-size: var(--type-size-body);
    --type-role-brand-tracking: var(--type-tracking-none);
    --type-role-puzzle-id-size: var(--type-size-heading);
    --type-role-puzzle-pill-tracking: var(--type-tracking-none);
    --type-role-puzzle-meta-size: var(--type-size-body);
    --type-role-puzzle-meta-weight: var(--type-weight-medium);
    --type-role-puzzle-status-size: var(--type-size-body);
    --type-role-panel-title-size: var(--type-size-heading);
    --type-role-panel-close-icon-size: var(--type-size-heading);
  }
}

:root[data-theme="light"] {
  color-scheme: light;
}

:root[data-theme="dark"] {
  color-scheme: dark;
  --color-bg-primary: #1a1a2e;
  --color-bg-panel: #252540;
  --color-bg-panel-section: #1e1e36;
  --color-bg-overlay: rgb(7 8 16 / 82%);
  --color-bg-card-muted: rgb(14 15 26 / 45%);
  --color-bg-progress-track: rgb(0 0 0 / 25%);
  --color-bg-button: #3a3a55;
  --color-bg-button-hover: #4a4a65;
  --color-bg-button-active: #4caf50;
  --color-bg-button-active-hover: #5cbf60;
  --color-bg-danger-soft: rgb(224 85 85 / 8%);

  --color-fg-primary: #e0e0e0;
  --color-fg-secondary: #8888a0;
  --color-fg-muted: #606078;
  --color-fg-inverse: #ffffff;

  --color-border-default: #3a3a55;

  --color-accent-info: #d4a017;
  --color-accent-success: #4caf50;
  --color-accent-danger: #e05555;
  --color-accent-danger-hover: #c84d4d;

  --shadow-success-pulse: 0 0 1rem rgb(76 175 80 / 50%);
  --shadow-danger-pulse: 0 0 1rem rgb(224 85 85 / 60%);
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    color-scheme: dark;
    --color-bg-primary: #1a1a2e;
    --color-bg-panel: #252540;
    --color-bg-panel-section: #1e1e36;
    --color-bg-overlay: rgb(7 8 16 / 82%);
    --color-bg-card-muted: rgb(14 15 26 / 45%);
    --color-bg-progress-track: rgb(0 0 0 / 25%);
    --color-bg-button: #3a3a55;
    --color-bg-button-hover: #4a4a65;
    --color-bg-button-active: #4caf50;
    --color-bg-button-active-hover: #5cbf60;
    --color-bg-danger-soft: rgb(224 85 85 / 8%);

    --color-fg-primary: #e0e0e0;
    --color-fg-secondary: #8888a0;
    --color-fg-muted: #606078;
    --color-fg-inverse: #ffffff;

    --color-border-default: #3a3a55;

    --color-accent-info: #d4a017;
    --color-accent-success: #4caf50;
    --color-accent-danger: #e05555;
    --color-accent-danger-hover: #c84d4d;
  }
}
